# ç”»åƒé…å»¶ç”Ÿæˆæ©Ÿèƒ½ æœ¬ç•ªãƒªãƒªãƒ¼ã‚¹å®Œå…¨ã‚¬ã‚¤ãƒ‰

**ä½œæˆæ—¥**: 2025-09-21
**æ›´æ–°æ—¥**: 2025-09-22
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 2.0.0ï¼ˆçµ±åˆç‰ˆï¼‰

---

## ğŸ“¦ å¿…è¦ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

### ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ3ãƒ•ã‚¡ã‚¤ãƒ« - deploy.shã§è‡ªå‹•å®Ÿè¡Œï¼‰
1. `2025_09_19_120040_unify_image_tables_structure.php`
2. `2025_09_20_143715_drop_status_column_from_shop_images_table.php`
3. `2025_09_20_154503_add_uuid_to_review_images_table.php`

### ãƒ‡ãƒ¼ã‚¿ç§»è¡Œã‚³ãƒãƒ³ãƒ‰ï¼ˆ2ã¤ - æ‰‹å‹•å®Ÿè¡Œå¿…è¦ï¼‰
```bash
php artisan shop-images:migrate-data  # ShopImageæ—¢å­˜ãƒ‡ãƒ¼ã‚¿ç§»è¡Œ
php artisan images:fix-uuid           # UUIDçµ±ä¸€åŒ–
```

---

## ğŸš¨ æœ€é‡è¦äº‹é …ï¼ˆã“ã‚Œã‚’å¿˜ã‚Œã‚‹ã¨é…å»¶ç”ŸæˆãŒå‹•ä½œã—ã¾ã›ã‚“ï¼‰

### âš ï¸ largeãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒªãƒãƒ¼ãƒ ï¼ˆçµ¶å¯¾ã«å¿˜ã‚Œãªã„ï¼‰

```bash
# æœ¬ç•ªç’°å¢ƒã§ã¯largeãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå­˜åœ¨ã—ã€originalã¯å­˜åœ¨ã—ãªã„
# largeã‚’originalã«ãƒªãƒãƒ¼ãƒ ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ï¼ˆè¶…é‡è¦ï¼‰

cd /var/www/maji-kichi-backend/storage/app/public/images/
sudo mv shops/large shops/original      # â† ã“ã‚Œå¿˜ã‚Œã‚‹ã¨å‹•ã‹ãªã„ï¼
sudo mv reviews/large reviews/original   # â† ã“ã‚Œå¿˜ã‚Œã‚‹ã¨å‹•ã‹ãªã„ï¼

# æ¨©é™ç¢ºèª
sudo chown -R www-data:www-data shops/original reviews/original
```

**ãªãœå¿…è¦ï¼Ÿ**
- æ–°ã‚·ã‚¹ãƒ†ãƒ ã¯`original`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰å„ã‚µã‚¤ã‚ºã‚’ç”Ÿæˆ
- æœ¬ç•ªç’°å¢ƒã«ã¯`large`ã—ã‹å­˜åœ¨ã—ãªã„
- ãƒªãƒãƒ¼ãƒ ã—ãªã„ã¨å…ƒç”»åƒãŒè¦‹ã¤ã‹ã‚‰ãšã‚¨ãƒ©ãƒ¼ã«ãªã‚‹

---

## ğŸ“‹ äº‹å‰æº–å‚™ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### 1. ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã®ç¢ºèª
- [ ] ãƒ‘ã‚¿ãƒ¼ãƒ³Aãƒ†ã‚¹ãƒˆï¼ˆå®Œå…¨ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰å®Ÿæ–½æ¸ˆã¿
- [ ] ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯â†’å†ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ†ã‚¹ãƒˆæˆåŠŸ
- [ ] ãƒ‡ãƒ¼ã‚¿ç§»è¡Œã‚³ãƒãƒ³ãƒ‰ã®å†ªç­‰æ€§ç¢ºèªï¼ˆ3å›å®Ÿè¡Œã—ã¦ã‚¨ãƒ©ãƒ¼ãªã—ï¼‰

### 2. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æº–å‚™
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚³ãƒãƒ³ãƒ‰æº–å‚™
- [ ] ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚³ãƒãƒ³ãƒ‰æº–å‚™
- [ ] ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä¿å­˜å…ˆã®ç©ºãå®¹é‡ç¢ºèª

### 3. é–‹ç™ºç’°å¢ƒã§ã®ãƒ†ã‚¹ãƒˆ
- [ ] ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ: `bash backend/scripts/test-migration-rollback.sh`
- [ ] ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãƒ¢ãƒ¼ãƒ‰æº–å‚™ç¢ºèª
- [ ] ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †æ›¸ç¢ºèª

---

## ğŸš€ æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œæ‰‹é †

### Phase 1: äº‹å‰æº–å‚™ã¨ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
```bash
# SSHãƒ­ã‚°ã‚¤ãƒ³
ssh sakura-vps

# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆï¼ˆå¿…é ˆï¼‰
mysqldump -u maji_kichi_user -p maji_kichi_meshi > ~/backup_db_$(date +%Y%m%d_%H%M%S).sql
tar -czf ~/backup_images_$(date +%Y%m%d_%H%M%S).tar.gz /var/www/maji-kichi-backend/storage/app/public/images/
```
- [ ] SSHãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ
- [ ] ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ
- [ ] ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«åè¨˜éŒ²: ________________

### Phase 2: å¿…é ˆãƒªãƒãƒ¼ãƒ ä½œæ¥­ï¼ˆè¶…é‡è¦ï¼‰
```bash
cd /var/www/maji-kichi-backend/storage/app/public/images/

# ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
ls -la shops/     # large, thumbnail ãŒå­˜åœ¨ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
ls -la reviews/   # large, thumbnail ãŒå­˜åœ¨ã™ã‚‹ã“ã¨ã‚’ç¢ºèª

# ãƒªãƒãƒ¼ãƒ å®Ÿè¡Œ
sudo mv shops/large shops/original
sudo mv reviews/large reviews/original

# çµæœç¢ºèª
ls -la shops/     # original, thumbnail ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
ls -la reviews/   # original, thumbnail ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª

# æ¨©é™è¨­å®š
sudo chown -R www-data:www-data shops/original reviews/original
```
- [ ] shops/large â†’ shops/original ãƒªãƒãƒ¼ãƒ å®Œäº†
- [ ] reviews/large â†’ reviews/original ãƒªãƒãƒ¼ãƒ å®Œäº†
- [ ] æ¨©é™è¨­å®šå®Œäº†

### Phase 3: ã‚³ãƒ¼ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤
```bash
# ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãƒ¢ãƒ¼ãƒ‰é–‹å§‹
cd /var/www/maji-kichi-backend
sudo -u www-data php artisan down --render="errors::503" --retry=60

# ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¸ç§»å‹•
cd ~/deployment/maji-kichi-meshi/

# æœ€æ–°ã‚³ãƒ¼ãƒ‰å–å¾—
git pull origin main

# ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œï¼ˆãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è‡ªå‹•å®Ÿè¡Œï¼‰
./deploy.sh
```
- [ ] ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãƒ¢ãƒ¼ãƒ‰é–‹å§‹
- [ ] git pullæˆåŠŸ
- [ ] deploy.shå®Ÿè¡ŒæˆåŠŸï¼ˆãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è‡ªå‹•å®Ÿè¡Œï¼‰

### Phase 4: ãƒ‡ãƒ¼ã‚¿ç§»è¡Œ
```bash
cd /var/www/maji-kichi-backend

# ãƒ‡ãƒ¼ã‚¿ç§»è¡Œã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œï¼ˆæœ¬ç•ªç’°å¢ƒã§ï¼‰
sudo -u www-data php artisan shop-images:migrate-data
sudo -u www-data php artisan images:fix-uuid

# ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
sudo -u www-data php artisan cache:clear
sudo -u www-data php artisan config:cache
sudo -u www-data php artisan route:cache

# ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãƒ¢ãƒ¼ãƒ‰è§£é™¤
sudo -u www-data php artisan up
```
- [ ] shop-images:migrate-data æˆåŠŸï¼ˆä»¶æ•°: _____ï¼‰
- [ ] images:fix-uuid æˆåŠŸï¼ˆä»¶æ•°: _____ï¼‰
- [ ] ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Œäº†
- [ ] ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãƒ¢ãƒ¼ãƒ‰è§£é™¤

### Phase 5: å‹•ä½œç¢ºèª

#### APIå‹•ä½œç¢ºèª
```bash
# ãƒ¬ãƒ“ãƒ¥ãƒ¼APIï¼ˆç”»åƒURLsç¢ºèªï¼‰
curl https://maji-kichi-meshi.takemitsu.net/api/reviews/1 | jq '.data.images'

# ç”»åƒé…ä¿¡APIï¼ˆé…å»¶ç”Ÿæˆï¼‰
curl -I https://maji-kichi-meshi.takemitsu.net/api/images/reviews/small/[filename]
```
- [ ] ãƒ¬ãƒ“ãƒ¥ãƒ¼APIã§urlsé…åˆ—ãŒè¿”ã‚‹
- [ ] ç”»åƒé…ä¿¡APIã§200 OKãŒè¿”ã‚‹

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç¢ºèª
- [ ] åº—èˆ—è©³ç´°ãƒšãƒ¼ã‚¸ã§ç”»åƒè¡¨ç¤º
- [ ] ãƒ¬ãƒ“ãƒ¥ãƒ¼ä¸€è¦§ã§ç”»åƒè¡¨ç¤º
- [ ] æ–°è¦ãƒ¬ãƒ“ãƒ¥ãƒ¼æŠ•ç¨¿ã§ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

#### ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆç¢ºèª
```bash
cd /var/www/maji-kichi-backend/storage/app/public/images/

# åˆå›ã‚¢ã‚¯ã‚»ã‚¹å¾Œã€æ–°ã—ã„ã‚µã‚¤ã‚ºãŒç”Ÿæˆã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
ls -la reviews/small/    # é…å»¶ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«
ls -la reviews/medium/   # é…å»¶ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«
```
- [ ] small/mediumãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆç¢ºèª

#### ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯
```bash
cd /var/www/maji-kichi-backend
sudo -u www-data php artisan tinker --execute="
    \$incomplete = \App\Models\ShopImage::whereNull('thumbnail_path')->count();
    echo 'Incomplete migrations: ' . \$incomplete;
"
```
- [ ] ä¸å®Œå…¨ãªç§»è¡ŒãŒãªã„ã“ã¨ã‚’ç¢ºèª

#### ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ç¢ºèª
```bash
tail -f /var/www/maji-kichi-backend/storage/logs/laravel-$(date +%Y-%m-%d).log
```
- [ ] ã‚¨ãƒ©ãƒ¼ãªã—ã€ã¾ãŸã¯æƒ³å®šå†…ã®ã‚¨ãƒ©ãƒ¼ã®ã¿

---

## ğŸ”„ ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †ï¼ˆå¿…è¦ãªå ´åˆï¼‰

### 1. ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯
```bash
cd /var/www/maji-kichi-backend

# ç”»åƒé…å»¶ç”Ÿæˆé–¢é€£ã®3ã¤ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯
sudo -u www-data php artisan migrate:rollback --step=3

# ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ç¢ºèª
php artisan migrate:status | grep 2025_09
```

### 2. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã‚’å…ƒã«æˆ»ã™
```bash
cd /var/www/maji-kichi-backend/storage/app/public/images/
sudo mv shops/original shops/large
sudo mv reviews/original reviews/large
```

### 3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒªã‚¹ãƒˆã‚¢ï¼ˆæœ€çµ‚æ‰‹æ®µï¼‰
```bash
# MySQLã®å ´åˆ
mysql -u maji_kichi_user -p maji_kichi_meshi < ~/backup_db_[timestamp].sql

# SQLiteã®å ´åˆï¼ˆé–‹ç™ºç’°å¢ƒï¼‰
cp database/backup_*.sqlite database/database.sqlite
```

---

## ğŸ› ï¸ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å¤±æ•—ã¨å¯¾å‡¦æ³•

#### 1. ã€Œoriginalç”»åƒãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€ã‚¨ãƒ©ãƒ¼
**åŸå› **: largeãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒªãƒãƒ¼ãƒ ã‚’å¿˜ã‚ŒãŸ
**å¯¾å‡¦**:
```bash
cd /var/www/maji-kichi-backend/storage/app/public/images/
sudo mv shops/large shops/original
sudo mv reviews/large reviews/original
```

#### 2. ãƒ‡ãƒ¼ã‚¿ç§»è¡Œã‚³ãƒãƒ³ãƒ‰ãŒ0ä»¶å‡¦ç†
**åŸå› **: ã™ã§ã«ç§»è¡Œæ¸ˆã¿ï¼ˆå†ªç­‰æ€§ã«ã‚ˆã‚Šæ­£å¸¸ï¼‰
**å¯¾å‡¦**: å•é¡Œãªã—ã€æ¬¡ã«é€²ã‚€

#### 3. æ¨©é™ã‚¨ãƒ©ãƒ¼
**åŸå› **: www-dataãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ¨©é™ä¸è¶³
**å¯¾å‡¦**:
```bash
sudo chown -R www-data:www-data /var/www/maji-kichi-backend/storage/
```

### ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å¤±æ•—æ™‚ã®å¯¾å‡¦

#### ã‚±ãƒ¼ã‚¹1: NOT NULLåˆ¶ç´„ã‚¨ãƒ©ãƒ¼
```sql
-- æ‰‹å‹•ã§NULLå€¤ã‚’è¨±å¯
ALTER TABLE review_images MODIFY large_path VARCHAR(255) NULL;
```

#### ã‚±ãƒ¼ã‚¹2: ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹é‡è¤‡ã‚¨ãƒ©ãƒ¼
```sql
-- æ—¢å­˜ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å‰Šé™¤
DROP INDEX shop_images_shop_id_index ON shop_images;
```

#### ã‚±ãƒ¼ã‚¹3: ã‚«ãƒ©ãƒ ãŒæ—¢ã«å‰Šé™¤ã•ã‚Œã¦ã„ã‚‹
```bash
# ã‚¨ãƒ©ãƒ¼ã‚’ç„¡è¦–ã—ã¦æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¸é€²ã‚€
php artisan migrate:rollback --step=1 --force
```

### ç™ºè¦‹ã•ã‚ŒãŸå•é¡Œã¨å¯¾ç­–æ¸ˆã¿äº‹é …

1. **NOT NULLåˆ¶ç´„ã«ã‚ˆã‚‹ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å¤±æ•—**
   - å¯¾ç­–: large_pathã¯nullableã®ã¾ã¾ä¿æŒ

2. **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹é‡è¤‡ã‚¨ãƒ©ãƒ¼**
   - å¯¾ç­–: ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å­˜åœ¨ç¢ºèªã‚’è¿½åŠ 

3. **ãƒ‡ãƒ¼ã‚¿ç§»è¡Œã‚³ãƒãƒ³ãƒ‰ã®å‰ææ¡ä»¶ä¸è¶³**
   - å¯¾ç­–: ã‚«ãƒ©ãƒ å­˜åœ¨ç¢ºèªã‚’è¿½åŠ 

---

## âš ï¸ é‡è¦ãªæ³¨æ„äº‹é …

### ã—ã¦ã¯ã„ã‘ãªã„ã“ã¨

1. **éƒ¨åˆ†çš„ãªãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ**
   - âŒ 1ã¤ãšã¤ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œ
   - âœ… ã™ã¹ã¦ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä¸€åº¦ã«å®Ÿè¡Œ

2. **ãƒ‡ãƒ¼ã‚¿ç§»è¡Œå‰ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯**
   - âŒ ãƒ‡ãƒ¼ã‚¿ç§»è¡Œã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå¾Œã«ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯
   - âœ… ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã™ã‚‹å ´åˆã¯å¿…ãšãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰å¾©å…ƒ

3. **æœ¬ç•ªç’°å¢ƒã§ã®æœªæ¤œè¨¼ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ**
   - âŒ é–‹ç™ºç’°å¢ƒã§ãƒ†ã‚¹ãƒˆã›ãšã«æœ¬ç•ªå®Ÿè¡Œ
   - âœ… å¿…ãšé–‹ç™ºç’°å¢ƒã§å…¨æ‰‹é †ã‚’æ¤œè¨¼

### ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

1. **ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã¯æœ€çµ‚æ‰‹æ®µ**
   - åŸºæœ¬çš„ã«å‰é€²ã®ã¿ï¼ˆforward-onlyï¼‰
   - å•é¡ŒãŒã‚ã‚Œã°ä¿®æ­£ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ 

2. **æ®µéšçš„ãƒ‡ãƒ—ãƒ­ã‚¤**
   - ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã§ååˆ†ã«ãƒ†ã‚¹ãƒˆ
   - ã‚«ãƒŠãƒªã‚¢ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã®æ¤œè¨

3. **ç›£è¦–ã¨ã‚¢ãƒ©ãƒ¼ãƒˆ**
   - ãƒ‡ãƒ—ãƒ­ã‚¤ç›´å¾Œã¯é‡ç‚¹çš„ã«ç›£è¦–
   - ã‚¨ãƒ©ãƒ¼ç‡ã®æ€¥å¢—ã‚’å³åº§ã«æ¤œçŸ¥

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«

### è‡ªå‹•ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```bash
# ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
bash backend/scripts/test-migration-rollback.sh

# æœ¬ç•ªç’°å¢ƒã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆè¦æ³¨æ„ï¼‰
bash backend/scripts/test-migration-rollback.sh --production
```

### æ‰‹å‹•æ¤œè¨¼ã‚³ãƒãƒ³ãƒ‰
```bash
# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹ç¢ºèª
php artisan migrate:status

# ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ç¢ºèª
php artisan tinker --execute="
    print_r([
        'ShopImages' => \App\Models\ShopImage::count(),
        'ReviewImages' => \App\Models\ReviewImage::count(),
        'WithoutPath' => \App\Models\ShopImage::whereNull('thumbnail_path')->count(),
        'WithoutUUID' => \App\Models\ReviewImage::whereNull('uuid')->count(),
    ]);
"
```

---

## ğŸ“ ãƒ‡ãƒ—ãƒ­ã‚¤è¨˜éŒ²ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

| é …ç›® | å†…å®¹ |
|------|------|
| ãƒ‡ãƒ—ãƒ­ã‚¤æ—¥æ™‚ | |
| å®Ÿè¡Œè€… | |
| ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ« | DB: ____________ <br> Images: ____________ |
| ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœ | |
| ãƒ‡ãƒ¼ã‚¿ç§»è¡Œä»¶æ•° | ShopImage: _____ <br> ReviewImage: _____ |
| å•é¡Œç™ºç”Ÿ | ãªã— / ã‚ã‚Šï¼ˆè©³ç´°ï¼š___________ï¼‰ |
| ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å®Ÿæ–½ | ãªã— / ã‚ã‚Šï¼ˆç†ç”±ï¼š___________ï¼‰ |

---

## ğŸ”— é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [ãƒªãƒãƒ¼ã‚µãƒ«è¨ˆç”»](./rehearsal-plan.md) - é–‹ç™ºç’°å¢ƒã§ã®äº‹å‰ãƒ†ã‚¹ãƒˆ
- [ãƒ‘ã‚¿ãƒ¼ãƒ³Aãƒ†ã‚¹ãƒˆçµæœ](./pattern-a-test-result.md) - å®Ÿæ–½æ¸ˆã¿ãƒ†ã‚¹ãƒˆã®è¨˜éŒ²
- [å®Ÿè£…è¨ˆç”»](./01-implementation-plan.md) - åˆæœŸå®Ÿè£…è¨ˆç”»
- [é€²æ—ç®¡ç†](./progress.md) - é–‹ç™ºé€²æ—è¨˜éŒ²

---

**é‡è¦**: ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ç”»åƒé…å»¶ç”Ÿæˆæ©Ÿèƒ½ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«ç‰¹åŒ–ã—ã¦ã„ã¾ã™ã€‚
ä»–ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¯é©ç”¨ã—ãªã„ã§ãã ã•ã„ã€‚

ç‰¹ã«ã€Œ**largeãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒªãƒãƒ¼ãƒ **ã€ã¯çµ¶å¯¾ã«å¿˜ã‚Œãªã„ã“ã¨ï¼